{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"DC1_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9412846960127353, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 9.678668415546417, "policy_loss": -0.0006863072980195284, "vf_loss": 9.679281330108642, "vf_explained_var": -0.0005524821579456329, "kl": 0.00036776555189135254, "entropy": 1.425710229575634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "high_level_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.030927000194788, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 8.404227864742278, "policy_loss": -0.0036198167130351067, "vf_loss": 8.407098430395127, "vf_explained_var": 0.0005641646683216095, "kl": 0.0037467143880348885, "entropy": 4.339958435297012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "DC2_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.852130089327693, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 9.717068707942962, "policy_loss": -0.0005774638848379254, "vf_loss": 9.717563736438752, "vf_explained_var": -0.000696544349193573, "kl": 0.0004131267017328355, "entropy": 1.4136953309178353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "DC3_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8206823650747538, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 9.81918923854828, "policy_loss": -0.001567544467980042, "vf_loss": 9.82054740190506, "vf_explained_var": -0.00016943365335464478, "kl": 0.0010471533822510536, "entropy": 1.4054628163576126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 566.5178161317143, "num_env_steps_trained_throughput_per_sec": 566.5178161317143, "timesteps_total": 2048, "num_env_steps_sampled_lifetime": 2048, "num_agent_steps_sampled_lifetime": 8192, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 3615.078, "restore_workers_time_ms": 0.026, "training_step_time_ms": 3615.005, "sample_time_ms": 2357.686, "learn_time_ms": 1233.569, "learn_throughput": 1660.224, "synch_weights_time_ms": 11.4}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "training_iteration": 1, "trial_id": "304ee_00000", "date": "2024-10-21_21-55-42", "timestamp": 1729547742, "time_this_iter_s": 3.6186110973358154, "time_total_s": 3.6186110973358154, "pid": 2943696, "hostname": "ai25", "node_ip": "10.93.232.115", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "truly_hierarchical_dcrl", "env_config": {"config1": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_NY_New.York-LaGuardia.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 8, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "config2": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_AZ_Phoenix-Sky.Harbor.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 0, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "config3": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_CA_San.Jose-Mineta.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 16, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "num_transfers": 2, "active_agents": [""], "low_level_actor_config": {"harl": {"algo": "haa2c", "env": "dcrl", "exp_name": "ll_actor", "model_dir": "/lustre/guillant/green-dcc/envs/seed-00001-2024-05-01-21-50-12"}, "rllib": {"checkpoint_path": "/lustre/guillant/green-dcc/envs/maddpg/checkpoint_000000/", "is_maddpg": true}}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": 2.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 2048, "num_epochs": 5, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f44c39279a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"high_level_policy": [null, "Box(-10.0, 10.0, (6,), float32)", "Box(-1.0, 1.0, (3,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a06d0>"], "DC1_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a05b0>"], "DC2_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a04f0>"], "DC3_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a0430>"]}, "callbacks": "<class 'custom_callbacks.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.6186110973358154, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.083333333333332, "ram_util_percent": 3.883333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"DC1_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8590470373630523, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 9.796900856494904, "policy_loss": -0.00024408929748460652, "vf_loss": 9.79714024066925, "vf_explained_var": -0.001442503184080124, "kl": 4.769672442250794e-05, "entropy": 1.4322362586855888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "high_level_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7909885458648205, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 8.685392498970032, "policy_loss": -0.005589685041923076, "vf_loss": 8.690177100896836, "vf_explained_var": -0.0012628220021724701, "kl": 0.008051676624535315, "entropy": 4.23008331656456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "DC2_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1005153376609087, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 9.788057422637939, "policy_loss": -0.0017757666995748878, "vf_loss": 9.789682447910309, "vf_explained_var": -0.001696334034204483, "kl": 0.0015067400214377393, "entropy": 1.432731455564499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "DC3_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9248999431729317, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 9.819615864753723, "policy_loss": -0.003851386165479198, "vf_loss": 9.823091554641724, "vf_explained_var": -0.0011233851313591004, "kl": 0.003756805112977446, "entropy": 1.3769425749778748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 595.8385177921926, "num_env_steps_trained_throughput_per_sec": 595.8385177921926, "timesteps_total": 4096, "num_env_steps_sampled_lifetime": 4096, "num_agent_steps_sampled_lifetime": 16384, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 3526.13, "restore_workers_time_ms": 0.021, "training_step_time_ms": 3526.069, "sample_time_ms": 2288.916, "learn_time_ms": 1213.043, "learn_throughput": 1688.316, "synch_weights_time_ms": 10.987}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "training_iteration": 2, "trial_id": "304ee_00000", "date": "2024-10-21_21-55-46", "timestamp": 1729547746, "time_this_iter_s": 3.440768241882324, "time_total_s": 7.05937933921814, "pid": 2943696, "hostname": "ai25", "node_ip": "10.93.232.115", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "truly_hierarchical_dcrl", "env_config": {"config1": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_NY_New.York-LaGuardia.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 8, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "config2": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_AZ_Phoenix-Sky.Harbor.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 0, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "config3": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_CA_San.Jose-Mineta.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 16, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "num_transfers": 2, "active_agents": [""], "low_level_actor_config": {"harl": {"algo": "haa2c", "env": "dcrl", "exp_name": "ll_actor", "model_dir": "/lustre/guillant/green-dcc/envs/seed-00001-2024-05-01-21-50-12"}, "rllib": {"checkpoint_path": "/lustre/guillant/green-dcc/envs/maddpg/checkpoint_000000/", "is_maddpg": true}}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": 2.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 2048, "num_epochs": 5, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f44c398e710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"high_level_policy": [null, "Box(-10.0, 10.0, (6,), float32)", "Box(-1.0, 1.0, (3,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f4390bab910>"], "DC1_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f44c3835990>"], "DC2_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f44c3835a80>"], "DC3_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f44c38355a0>"]}, "callbacks": "<class 'custom_callbacks.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.05937933921814, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.96, "ram_util_percent": 3.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"DC1_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6520564779639244, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 5.000000000000001e-05, "total_loss": 9.565464007854462, "policy_loss": -0.0010084310197271407, "vf_loss": 9.566437017917632, "vf_explained_var": -0.003994965553283691, "kl": 0.0007085301348091433, "entropy": 1.4153045833110809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "high_level_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9961075752973556, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 8.441447788476944, "policy_loss": -0.003270187368616462, "vf_loss": 8.444173592329026, "vf_explained_var": 0.0001171506941318512, "kl": 0.00544319918485602, "entropy": 4.151986223459244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "DC2_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1082639094442128, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 5.000000000000001e-05, "total_loss": 9.818713617324828, "policy_loss": -0.004543596890289337, "vf_loss": 9.822928786277771, "vf_explained_var": -0.004046555608510971, "kl": 0.006569096756794587, "entropy": 1.440904976427555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "DC3_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3364504896104337, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 5.000000000000001e-05, "total_loss": 9.562228965759278, "policy_loss": -0.0013678594958037138, "vf_loss": 9.563545620441436, "vf_explained_var": -0.0031867489218711854, "kl": 0.0010261242792609163, "entropy": 1.3940903425216675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 597.7177578914306, "num_env_steps_trained_throughput_per_sec": 597.7177578914306, "timesteps_total": 6144, "num_env_steps_sampled_lifetime": 6144, "num_agent_steps_sampled_lifetime": 24576, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 3492.879, "restore_workers_time_ms": 0.02, "training_step_time_ms": 3492.816, "sample_time_ms": 2258.604, "learn_time_ms": 1206.908, "learn_throughput": 1696.898, "synch_weights_time_ms": 11.938}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "training_iteration": 3, "trial_id": "304ee_00000", "date": "2024-10-21_21-55-49", "timestamp": 1729547749, "time_this_iter_s": 3.431985855102539, "time_total_s": 10.491365194320679, "pid": 2943696, "hostname": "ai25", "node_ip": "10.93.232.115", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "truly_hierarchical_dcrl", "env_config": {"config1": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_NY_New.York-LaGuardia.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 8, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "config2": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_AZ_Phoenix-Sky.Harbor.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 0, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "config3": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_CA_San.Jose-Mineta.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 16, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "num_transfers": 2, "active_agents": [""], "low_level_actor_config": {"harl": {"algo": "haa2c", "env": "dcrl", "exp_name": "ll_actor", "model_dir": "/lustre/guillant/green-dcc/envs/seed-00001-2024-05-01-21-50-12"}, "rllib": {"checkpoint_path": "/lustre/guillant/green-dcc/envs/maddpg/checkpoint_000000/", "is_maddpg": true}}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": 2.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 2048, "num_epochs": 5, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f44c3927640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"high_level_policy": [null, "Box(-10.0, 10.0, (6,), float32)", "Box(-1.0, 1.0, (3,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a0460>"], "DC1_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a0520>"], "DC2_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a0610>"], "DC3_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a0730>"]}, "callbacks": "<class 'custom_callbacks.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.491365194320679, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.95, "ram_util_percent": 3.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"DC1_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0612006813287735, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 9.55380539894104, "policy_loss": -0.003065868467092514, "vf_loss": 9.556791150569916, "vf_explained_var": 0.0001493990421295166, "kl": 0.003203998427107289, "entropy": 1.3601906016469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "high_level_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0403839871287346, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 8.242408215999603, "policy_loss": -0.004045023955404759, "vf_loss": 8.245992195606231, "vf_explained_var": 0.00034462884068489077, "kl": 0.004610644879557034, "entropy": 4.126372528076172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "DC2_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0878894180059433, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 5.000000000000001e-05, "total_loss": 9.887232625484467, "policy_loss": -0.0012259213486686348, "vf_loss": 9.888360524177552, "vf_explained_var": -0.0036133967339992525, "kl": 0.001957458254730682, "entropy": 1.4109671756625175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "DC3_ls_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4245569169521333, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 9.516952276229858, "policy_loss": -0.00180401160614565, "vf_loss": 9.518705248832703, "vf_explained_var": -0.004546068608760834, "kl": 0.0020439182804096847, "entropy": 1.3595440894365312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 603.6429526643344, "num_env_steps_trained_throughput_per_sec": 603.6429526643344, "timesteps_total": 8192, "num_env_steps_sampled_lifetime": 8192, "num_agent_steps_sampled_lifetime": 32768, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 3467.847, "restore_workers_time_ms": 0.02, "training_step_time_ms": 3467.784, "sample_time_ms": 2243.588, "learn_time_ms": 1197.809, "learn_throughput": 1709.788, "synch_weights_time_ms": 11.655}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "training_iteration": 4, "trial_id": "304ee_00000", "date": "2024-10-21_21-55-53", "timestamp": 1729547753, "time_this_iter_s": 3.396605968475342, "time_total_s": 13.88797116279602, "pid": 2943696, "hostname": "ai25", "node_ip": "10.93.232.115", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "truly_hierarchical_dcrl", "env_config": {"config1": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_NY_New.York-LaGuardia.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 8, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "config2": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_AZ_Phoenix-Sky.Harbor.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 0, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "config3": {"location": "ca", "cintensity_file": "CA_NG_&_avgCI.csv", "weather_file": "USA_CA_San.Jose-Mineta.epw", "workload_file": "Alibaba_CPU_Data_Hourly_1.csv", "dc_config_file": "dc_config_dc1.json", "datacenter_capacity_mw": 1.0, "flexible_load": 0.4, "timezone_shift": 16, "month": 7, "days_per_episode": 30, "partial_obs": true, "nonoverlapping_shared_obs_space": true, "debug": false, "initialize_queue_at_reset": true, "agents": ["agent_ls"], "workload_baseline": 0.0}, "num_transfers": 2, "active_agents": [""], "low_level_actor_config": {"harl": {"algo": "haa2c", "env": "dcrl", "exp_name": "ll_actor", "model_dir": "/lustre/guillant/green-dcc/envs/seed-00001-2024-05-01-21-50-12"}, "rllib": {"checkpoint_path": "/lustre/guillant/green-dcc/envs/maddpg/checkpoint_000000/", "is_maddpg": true}}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": 2.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 2048, "num_epochs": 5, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f44c398ef80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"high_level_policy": [null, "Box(-10.0, 10.0, (6,), float32)", "Box(-1.0, 1.0, (3,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a11e0>"], "DC1_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a12d0>"], "DC2_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a1390>"], "DC3_ls_policy": [null, "Box(-10.0, 10.0, (15,), float32)", "Box(-1.0, 1.0, (1,), float32)", "<ray.rllib.algorithms.ppo.ppo.PPOConfig object at 0x7f446c7a1450>"]}, "callbacks": "<class 'custom_callbacks.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.88797116279602, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 6.279999999999999, "ram_util_percent": 3.9}}
